
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Living life and make it better</title>
  <meta name="author" content="Endy Muhardin">

  
  <meta name="description" content="Pada artikel ini, kita akan coba buat demo penggunaan JMS menggunakan Spring Framework dan ActiveMQ. Spring Framework 2.0 telah dilengkapi dengan &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://endy.artivisi.com/blog/page/37/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Living life and make it better" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<meta property="fb:app_id" content="269506799827290" />



  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">endymuhardin</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Living life and make it better</a></h1>
  
    <h2>life, learn, contribute</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:endy.artivisi.com/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/java/intro-jms/">Intro JMS</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2007-01-18T20:19:14+07:00" pubdate data-updated="true">Jan 18<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Pada artikel ini, kita akan coba buat demo penggunaan JMS menggunakan <a href="http://www.springframework.org">Spring Framework</a> dan <a href="http://incubator.apache.org/activemq">ActiveMQ</a>. Spring Framework 2.0 telah dilengkapi dengan helper class untuk memudahkan kita menggunakan JMS (Java Messaging Service). Sayangnya dokumentasi di Spring Reference kurang lengkap, sehingga ada beberapa bagian yang harus kita cari sendiri.</p>

<p>Jangan khawatir, bagian yang kurang tersebut bisa dibaca di artikel ini.</p>

<p>Berikut skenario yang ingin saya buat:</p>

<ol>
<li><p>Jalankan JMS server (kali ini saya gunakan ActiveMQ)</p></li>
<li><p>Siapkan <em>MessageListener</em>, yang akan bereaksi bila menerima pesan pada destination tertentu</p></li>
<li><p>Kirim beberapa pesan ke destination yang didengarkan oleh <em>MessageListener</em></p></li>
<li><p>Pastikan pesan tersebut diterima dengan baik</p></li>
</ol>


<p>Kita akan buat kasus sederhana saja, melibatkan tiga class:</p>

<ul>
<li><p>Sender.java : pengirim pesan</p></li>
<li><p>Receiver.java : penerima pesan (MessageListener)</p></li>
<li><p>Main.java : class untuk menjalankan pengirim dan penerima</p></li>
</ul>


<p>Berikut adalah kode programnya.</p>

<h3>Sender.java</h3>

<pre><code>```
package tutorial.spring.jms;

import javax.jms.JMSException;
import javax.jms.Message;
import javax.jms.Session;
import org.springframework.jms.core.JmsTemplate;
import org.springframework.jms.core.MessageCreator;

public class Sender {
    private String message = "default message";
    private JmsTemplate jmsTemplate;

    public void setJmsTemplate(JmsTemplate jmsTemplate) {
        this.jmsTemplate = jmsTemplate;
    }

    public void setMessage(String message) {
        this.message = message;
    }

    public void send() {
        jmsTemplate.send(new MessageCreator(){
            public Message createMessage(Session sess) throws JMSException {
                return sess.createTextMessage(message);
            }           
        });
    }
}
```
</code></pre>

<h3>Receiver.java</h3>

<pre><code>```
package tutorial.spring.jms;

import javax.jms.JMSException;

public class Receiver implements MessageListener {

    public void onMessage(Message msg){
        if (msg instanceof TextMessage) {
            TextMessage txtMsg = (TextMessage) msg;
            try {
                System.out.println(txtMsg.getText());
            } catch (JMSException e) {
                e.printStackTrace();
            }
        } else {
            System.out.println("Unsupported message type : "+msg.getClass());
        }
    }   
}
```
</code></pre>

<h3>Main.java</h3>

<pre><code>```
package tutorial.spring.jms;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class Main {
    public static void main(String[] args) {
        ApplicationContext ctx = new ClassPathXmlApplicationContext("jms-ctx.xml");
        Sender sender = (Sender) ctx.getBean("sender");

        sender.setMessage("Percobaan menggunakan JMS dengan Spring. ");     
        sender.send();

        sender.setMessage("Pesan ini seharusnya diterima oleh Message Driven POJO");
        sender.send();
    }
}
```
</code></pre>

<p>Integrasi antara kode Java dan ActiveMQ diatur di konfigurasi Spring, jms-ctx.xml. Berikut kodenya.</p>

<h3>jms-ctx.xml</h3>

<pre><code>```
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN" "http://www.springframework.org/dtd/spring-beans-2.0.dtd"&gt;
&lt;beans&gt;

    &lt;bean id="messageListener" class="tutorial.spring.jms.Receiver" /&gt;
    &lt;bean id="listenerContainer" class="org.springframework.jms.listener.SimpleMessageListenerContainer"&gt;
        &lt;property name="connectionFactory" ref="jmsConnectionFactory"/&gt;
        &lt;property name="destinationName" value="TEST.FOO"/&gt;
        &lt;property name="messageListener" ref="messageListener"/&gt;
    &lt;/bean&gt;

    &lt;bean id="jmsConnectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory"&gt;
        &lt;constructor-arg index="0"&gt;&lt;null/&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg index="1"&gt;&lt;null/&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg index="2" value="tcp://localhost:61616"&gt;&lt;/constructor-arg&gt;
    &lt;/bean&gt; 

    &lt;bean id="sender" class="tutorial.spring.jms.Sender"&gt;
        &lt;property name="jmsTemplate" ref="jmsTemplate"/&gt;        
    &lt;/bean&gt;

    &lt;bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate"&gt;
        &lt;property name="connectionFactory" ref="jmsConnectionFactory"/&gt;
        &lt;property name="defaultDestinationName" value="TEST.FOO"/&gt;
    &lt;/bean&gt;

&lt;/beans&gt;
```
</code></pre>

<p>Apabila kita ingin menggunakan JMS server yang lain (selain ActiveMQ), cukup ganti deklarasi <em>jmsConnectionFactory</em> pada <em>jms-ctx.xml</em> di atas. Destination name juga di-hard code dengan nilai <em>TEST.FOO</em>. Nantinya pada aplikasi nyata, nilai ini mungkin ingin kita konfigurasi lebih jauh, atau diparameterisasi dalam database.</p>

<p>ActiveMQ mendukung <em>dynamic destination creation</em>, artinya destination <em>TEST.FOO</em> akan dibuatkan bila belum ada. Pada aplikasi server JMS yang lain, mungkin kita harus membuat <em>TEST.FOO</em> secara manual di server tersebut.</p>

<p>Selamat mencoba, semoga sukses.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/lain/google-endy/">Google &#8220;Endy&#8221;</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2007-01-18T17:59:52+07:00" pubdate data-updated="true">Jan 18<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Masukkan <a href="http://www.google.co.id/search?hl=id&amp;q=endy&amp;meta=">keyword &#8220;endy&#8221; di Google Indonesia</a>. Lihat hasil search paling atas &#8230;</p>

<p><a href="/images/uploads/2007/01/endy-google-search.png">
<img src="/images/uploads/2007/01/endy-google-search-crop.png" title="Google Search &#34;endy&#34;. Klik untuk memperbesar" alt="Google Search &#34;endy&#34;. Klik untuk memperbesar">
</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/aplikasi/version-control-database/">Version Control Untuk Database</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2007-01-06T01:24:50+07:00" pubdate data-updated="true">Jan 6<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Menyimpan kode program Java ke repository tidak sulit. Yang lebih sulit adalah menyimpan artifak database, yaitu:</p>

<ul>
<li> Skema database</li>
<li> Stored Procedure</li>
<li> Functions</li>
<li> Sample/Initial data</li>
</ul>


<p>Kalau dilakukan dengan cara manual, akan sangat merepotkan, karena programmer harus melakukan langkah-langkah berikut untuk memastikan kode programnya tersimpan di repository:</p>

<ol>
<li>Copy semua source code melalui Query Editor</li>
<li>Paste satu per satu ke text file</li>
<li>Commit ke repository</li>
<li>Ulangi langkah 1 - 3 untuk setiap kali perubahan</li>
</ol>


<p>Dengan skala ribuan procedure, cara ini sangat merepotkan dan dijamin tidak akan dilakukan oleh programmer. Harus ada cara yang lebih baik.</p>

<p>Untungnya –seperti halnya masalah yang umum kita temukan– sudah banyak orang lain yang mengalami masalah sama, dan sudah ada yang memecahkannya. Kali ini solusinya adalah <a href="http://www.codeproject.com/cs/database/ScriptDB4Svn.asp" title="Homepage ScriptDB4SVN">ScriptDB4SVN</a>. Aplikasi kecil yang seumur hidupnya hanya bertugas melakukan langkah 1-3 di atas.</p>

<p>Sayangnya aplikasi ini hanya bisa digunakan untuk Microsoft SQL Server.</p>

<p>Aplikasi ini membutuhkan .Net Framework 2.0 yang dapat didownload secara cuma-cuma di website Microsoft. Segera setelah .Net Framework diinstal, kita dapat langsung menjalankan ScriptDB4SVN.</p>

<p>Sebelumnya, kita harus edit dulu file konfigurasinya. Kita harus beritahu ScriptDB4SVN tentang:</p>

<ul>
<li> Host database</li>
<li> Nama database yang akan digunakan</li>
<li> Daftar tabel yang akan didump datanya</li>
</ul>


<p>Berikut adalah contoh konfigurasinya</p>

<p>Setelah konfigurasi selesai dibuat, jalankan ScriptDB4SVN.exe. Hasilnya seperti ini.</p>

<p><img src="/images/uploads/2007/01/scriptdb4svn.png" title="Screenshot ScriptDB4SVN" ></p>

<p>Setiap kali ada perubahan di database, dobel-klik ScriptDB4SVN dan commit file yang berubah. Harus diperhatikan, ScriptDB4SVN tidak otomatis menjalankan svn add. Jadi kalau ada Store Procedure baru, kita harus jalankan svn add secara manual.</p>

<p>Pembaca yang teliti mungkin akan melihat script sql dengan nama aneh pada screenshot di atas. Itu adalah script replikasi. Kalau script tersebut dijalankan di Query Analyzer, maka dia akan merekonstruksi database sehingga sama dengan kondisi database target pada saat ScriptDB4SVN dijalankan.</p>

<p>Dengan adanya tools ini, masing-masing programmer dapat bekerja di database lokalnya sendiri. Secara periodik, dia harus melakukan svn update dan merekonstruksi database lokalnya dengan script terbaru sehingga tetap sinkron dengan kondisi terbaru.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/38/">&larr; Older</a>
    
    <a href="/archives">Blog Archives</a>
    
    <a class="next" href="/page/36/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/aplikasi/terima-kasih-wordpress/">Terima kasih Wordpress</a>
      </li>
    
      <li class="post">
        <a href="/java/konsep-dasar-log4/">Konsep Dasar Log4j</a>
      </li>
    
      <li class="post">
        <a href="/java/monitoring-aplikasi-java/">Monitoring Aplikasi Java</a>
      </li>
    
      <li class="post">
        <a href="/linux/backup-home-folder/">Backup Home Folder</a>
      </li>
    
      <li class="post">
        <a href="/java/manajemen/staged-deployment/">Staged Deployment</a>
      </li>
    
      <li class="post">
        <a href="/manajemen/meluruskan-mitos-cmmi/">Meluruskan Mitos CMMI</a>
      </li>
    
      <li class="post">
        <a href="/aplikasi/linux/redmine-jruby-tomca/">Instalasi Redmine di Tomcat</a>
      </li>
    
      <li class="post">
        <a href="/aplikasi/programming/instalasi-spket-ide/">Instalasi Spket IDE</a>
      </li>
    
      <li class="post">
        <a href="/aplikasi/linux/membuat-screencast/">Membuat Screencast</a>
      </li>
    
      <li class="post">
        <a href="/java/php/tutorial-extjs/">Tutorial ExtJS</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("endymuhardin", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/endymuhardin" class="twitter-follow-button" data-show-count="false">Follow @endymuhardin</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/110971146012275775230?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Endy Muhardin -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=269506799827290&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
